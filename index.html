<!DOCTYPE HTML>
<!--

    Copyright (C) 2011 Everit Kft. (http://www.everit.org)

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

            http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.

-->
<html>

<head>
<meta charset="utf-8">
<title>OSGi Testrunner</title>
<link rel="icon" type="image/ico" href="http://www.everit.org/fonts/favicon.ico">

<!--    <link rel="stylesheet" type="text/css" href="common/css/base.css">-->
<link href="http://www.everit.org/css/bootstrap.min.css" rel="stylesheet">
<link href="http://www.everit.org/css/docs.min.css" rel="stylesheet">
<link href="http://www.everit.org/css/everit.css" rel="stylesheet">
<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push([ '_setAccount', 'UA-15041869-4' ]);
	_gaq.push([ '_setDomainName', 'everit.org' ]);
	_gaq.push([ '_trackPageview' ]);
</script>
</head>

<body class="bs-docs-home" data-spy="scroll" data-target="#affix-nav">
  <a class="sr-only" href="#content">Skip to main content</a>
  <header class="navbar navbar-static-top bs-docs-nav" id="top" role="banner">
    <div class="container">
      <div class="navbar-header">
        <button class="navbar-toggle" type="button" data-toggle="collapse"
          data-target=".bs-navbar-collapse">
          <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span
            class="icon-bar"></span> <span class="icon-bar"></span>
        </button>
        <a href="#" class="navbar-brand">Index</a>
      </div>
      <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
        <ul class="nav navbar-nav">
          <li><a href="https://github.com/everit-org/osgi-testrunner" target="_blank">Source</a></li>
          <li><a href="http://www.everit.org/" target="_blank">Community</a></li>
        </ul>
        <ul class="nav navbar-nav navbar-right">
          <li><a href="http://www.everit.biz" target="_blank">Enterprise</a></li>
          <li><a href="http://everitorg.wordpress.com/" target="_blank">Blog</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <div class="bs-docs-masthead everit-header" id="content" role="main">
    <div class="container">
      <span class="bs-docs-booticon bs-docs-booticon-lg bs-docs-booticon-outline"> <img
        class="logo" src="http://www.everit.org/fonts/sbz_e.svg" alt="E">
      </span>
      <p class="lead">OSGi Test Runner</p>
    </div>
  </div>
  <div class="container">
    <div class="col-md-10">

      <div class="bs-docs-featurette cookbook">
        <h2 id="introduction" class="bs-docs-featurette-title">Introduction</h2>
        <p>
          The test runner bundle picks up tests and executes them. If you want to see the module in
          practice instead of reading its documentation, go through the chapters of the <a
            href="http://cookbook.everit.org">Everit Cookbook</a>.
        </p>
      </div>
      <hr class="featurette-divider">

      <div class="bs-docs-featurette cookbook">
        <h2 id="running_osgi_tests" class="bs-docs-featurette-title">Executing OSGi tests</h2>
        <p>The module picks up every OSGi service having the following service properties
          defined:</p>
        <ul>
          <li><b>eosgi.testId</b>: This property should have a value capable of being a part of
            a file name.</li>
          <li><b>eosgi.testEngine</b>: This property defines the test engine to which the test
            should be passed. Currently, there is a junit4 implementation in the <a
            href="https://github.com/everit-org/osgi-testrunner-junit4">osgi-testrunner-junit4</a>
            project.</li>
        </ul>
      </div>
      <hr class="featurette-divider">

      <div class="bs-docs-featurette cookbook">
        <h2 id="ordinary_junit_tests_vs_testrunner_bundle" class="bs-docs-featurette-title">Ordinary
          JUnit tests vs. testrunner bundle</h2>
        <p>The tests have to be provided as OSGi services, and the JUnit annotations are
          required to be placed into the implementation of the OSGi service.</p>
        <p>In ordinary JUnit based solutions, the programmer has to provide the class name so
          that the JUnit technology can instantiate the class. By using this bundle, the programmer
          instantiates the JUnit test class with any technology. E.g.: Declarative Services,
          Blueprint or Everit Component Model</p>
      </div>
      <hr class="featurette-divider">

      <div class="bs-docs-featurette cookbook">
        <h2 id="configuration" class="bs-docs-featurette-title">Configuration</h2>
        <h3>Test runner 5.0 and above</h3>
        <p>The following System or Framework properties make it easier to integrate the
          testrunner with build tools.</p>
        <ul>
          <li><b>eosgi.stopAfterTests</b>: In case this system property has the value "true",
            the testrunner bundle stops the OSGi container and the JVM after the tests are executed.
            The JVM will be stopped only if all <a href="#shutdown_blocker">ShutdownBlockers</a> are
            in non-blocking state.</li>
          <li><b>eosgi.testResultFolder</b>: By default, only test results in TEXT format are
            written out with the standard Java Logger. In case this system property is specified,
            the test results will be dumped in XML and TEXT format to the specified folder.</li>
          <li><b>eosgi.developmentMode</b>: In case this property is set to <i>true</i>, only
            those tests will be executed that are annotated with <i>@TestDuringDevelopment</i>.
            Either a method or a class can be annotated with the mentioned annotation. If a class is
            annotated with <i>@TestDuringDevelopment</i>, it means that all classes in the tests
            should be executed. Development mode is useful if we want to hot-deploy our test bundle
            or any bundle it depends on and we do not want all tests re-executed each time.</li>
        </ul>

        <h3>Test Runner 4.x and before</h3>
        <p>The following environment variables make it easier to integrate the testrunner with
          build tools.</p>
        <ul>
          <li><b>EOSGI_STOP_AFTER_TESTS</b>: In case this environment variable has the value
            "true", the testrunner bundle stops the OSGi container and the JVM after the tests are
            executed.</li>
          <li><b>ENV_TEST_RESULT_FOLDER</b>: By default, only test results in TEXT format are
            written out with the standard Java Logger. In case this environment variable is
            specified, the test results will be dumped in XML and TEXT format to the specified
            folder.</li>
        </ul>
      </div>

      <hr class="featurette-divider">

      <div class="bs-docs-featurette cookbook">
        <h2 id="shutdown_blocker" class="bs-docs-featurette-title">Shutdown blocker</h2>
        <p>
          In case the <i>"Stop after tests"</i> setting is set to true, the test runner will shut
          down the JVM after all tests are executed. However, it is not trivial how much the test
          runner should wait for. Shutdown Blocker OSGi services can be registered to tell the test
          runner to wait for more tests to be executed. The runner will shut down the JVM only if
          all blockers are in non-blocking state.
        </p>
        <p>There are two Shutdown Blockers by default:</p>
        <ul>
          <li><strong>FrameworkStartShutdownBlocker</strong> waits for the framework bundle to
            become active.</li>
          <li><strong><a href="#eosgi_testclass">TestClassShutdownBlocker</a></strong> Does not
            allow the test runner to shut down the JVM until all test classes that are specified
            with <i>eosgi.testClass</i> bundle capabilities are executed.</li>
        </ul>
      </div>

      <hr class="featurette-divider">

      <div class="bs-docs-featurette cookbook">
        <h2 id="eosgi_testclass" class="bs-docs-featurette-title">TestClass capability and
          annotation</h2>

        <p>
          The TestCase <a href="#shutdown_blocker">shutdown blocker</a> does not allow the test
          runner to shut down the JVM until all test classes that are specified with <i>eosgi.testClass</i>
          bundle capabilities are executed. An example:
        </p>
        <pre>Provide-Capability: eosgi.testClass;eosgi.testClass=foo.bar.MyTestClass;instanceCount=1</pre>
        <p>
          The <i>executionCount</i> attribute tells the blocker, how many times the test class
          should be executed. There might be cases when the same test class is registered multiple
          times with different configuration as OSGi services. The value of the <i>instanceCount</i>
          attribute is summarized so if multiple bundles contain the same capability, their values
          are summarized, even if the amount is a negative number.
        </p>
        <p>
          It is hard to specify the bundle capability manually always. Therefore, the programmer can
          use the <i>@EOSGiTestClass</i> annotation on the test class to specify the capability.
          E.g.:
        </p>
        <pre>
@EOSGiTestClass
public class MyTestClass {

  @Test
  public void myTestMethod() {
  }

}</pre>
      </div>

      <hr class="featurette-divider">

      <div class="bs-docs-featurette cookbook">
        <h2 id="maven_support" class="bs-docs-featurette-title">Maven support</h2>
        <p>
          The <a href="https://github.com/everit-org/eosgi-maven-plugin">eosgi-maven-plugin</a> uses
          the <i>testrunner</i> bundle to run the written tests as a part of the build lifecycle.
          Test runner 5.x is supported from the version 4.1.0 of <a
            href="https://github.com/everit-org/eosgi-maven-plugin">eosgi-maven-plugin</a>.
        </p>
      </div>
      <hr class="featurette-divider">
    </div>

    <!--        Affix-->
    <div class="col-md-2 col-sm-0 col-xs-0">
      <nav id="affix-nav">
        <ul class="nav nav-pills nav-stacked everit-affix" data-spy="affix" data-offset-top="350"
          data-offset-bottom="140">
          <li class="active"><a href="#introduction">Introduction</a></li>
          <li><a href="#running_osgi_tests">Running OSGi tests</a></li>
          <li><a href="#ordinary_junit_tests_vs_testrunner_bundle">Ordinary JUnit tests vs.
              testrunner bundle</a></li>
          <li><a href="#configuration">Configuration</a></li>
          <li><a href="#shutdown_blocker">Shutdown blocker</a></li>
          <li><a href="#eosgi_testclass">TestClass capability and annotation</a></li>
          <li><a href="#maven_support">Maven support</a></li>
        </ul>
      </nav>
    </div>
  </div>

  <div></div>
  <footer class="bs-docs-footer" role="contentinfo">
    <div class="container">
      <div class="bs-docs-social">
        <ul class="bs-docs-social-buttons">
          <li class="follow-btn "><a href="https://twitter.com/EveritOrg"
            class="twitter-follow-button" data-show-count="true">Follow @EveritOrg</a></li>
          <li class="tweet-btn"><a href="https://twitter.com/share"
            class="twitter-share-button" data-url="http://www.everit.org/">Tweet</a></li>
        </ul>
      </div>
    </div>
  </footer>

  <!-- Bootstrap core JavaScript
================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script src="http://www.everit.org/js/jquery-2.1.1.min.js"></script>
  <script src="http://www.everit.org/js/bootstrap.min.js"></script>
  <script src="http://www.everit.org/js/everit.js "></script>
  <script type="text/javascript">
			(function() {
				var ga = document.createElement('script');
				ga.type = 'text/javascript';
				ga.async = true;
				ga.src = ('https:' == document.location.protocol ? 'https://ssl'
						: 'http://www')
						+ '.google-analytics.com/ga.js';
				var s = document.getElementsByTagName('script')[0];
				s.parentNode.insertBefore(ga, s);
			})();
		</script>
  <script src="http://www.everit.org/js/prettify/run_prettify.js"></script>
</body>

</html>
